---
sidebar_label: "探索 Sparky：玩转动作编辑"
sidebar_position: 4
---

# 探索 Sparky：玩转动作编辑

## 一、前言

<div className="indent-first-line">
“嘿，未来的机器狗训练大师！您已经和哮天一起踏上了探索之旅，熟悉了它的启动、互动及使用过程，这无疑为生活增添了许多乐趣。现在，让我们更进一步来玩转动作编辑，为哮天创造更多独一无二的动作组！”
</div>

## 二、准备工作

此篇文档是基于开箱指南下的 APP 使用方法的延续文，文档默认您已熟悉哮天的基础使用流程，故在这不介绍前序相关的使用步骤，如有需要请参考查阅以下资料。

> 资料：[初识 Sparky：开箱指南](https://hengbot-dynamics.github.io/heng-docs/docs/tutorial-basics/quick-start-guide)

### 2.1 硬件

- **哮天**  
  
![sparky](./img/app/sparky.jpg)

### 2.2 软件

- 哮天使用环境（固件版本：hzwl831-m2dock-20240621）  
  
  1. 第一步：默认是已联网状态并进入遥控模式  
  2. 第二步：可在屏幕获取 IP 地址（例如“IP:192.168.8.232” ）  
  3. 第三步：已连接好 SPARKY'S APP

## 三、示教模式  

在示教模式下，用户可摆动哮天的四肢和机身来教会它新动作。同时它会通过其电机位置传感器来记录动作，当需要复现动作时，哮天将执行记录的每一个动作或姿势。这种模式让个性化训练过程变得既简单又充满乐趣。

> 使用流程图  
> ![teach_process](./img/app/teach_process.jpg)

### 3.1 进入示教模式

| 示例图 | 操作描述 |
|------|-----|
| ![teach_mode](./img/app/teach_mode.jpg) | 我们可通过顶栏切换到示教模式，进页面后会提示恢复初始姿态，按“确认”即可。|
| ![teach_lock](./img/app/teach_lock.jpg) | 页面上显示了哮天的俯视线稿图，所有电机部位默认以红色高亮显示，并处于锁定状态。这意味着这些部位目前被固定，无法移动或执行动作。 |
| ![teach_unlock](./img/app/teach_unlock.jpg) | （图例：全身关节已解锁状态）开启录制前，用户根据动作需求点击 “锁” 的图标解锁相应的关节，解锁后关节呈卸力站立姿态，我们可开始对哮天“摆动作”进行录制。 |

### 3.2 开启动作录制

:::danger[Take care]
1. 录制新动作时，请考虑哮天的平衡或支撑力是否足够，防止哮天复现动作时重力不稳往后弹或跌倒。
2. 播放新录制的动作时，为防止录制完成后电机上电后导致机身弹起请握紧机身。
:::


| 示例图 | 操作描述 |
|------|-----|
| ![teach_start](./img/app/teach_start.jpg) | **第一步（进入录制）**：点击“添加动作”后进入“录制动作”，页面会提示三秒掉电倒计时，计时结束哮天进入站立但关节卸力姿态。**第二步（开始录制）**：在录制过程中，页面将持续显示计时，方便熟悉录制时长。我们可为哮天设计一系列有趣的动作，比如让它抬头、扭动身体等。同时也可参照示例动作组进行学习和复现。|
| ![teach_stop](./img/app/teach_stop.jpg) | **第三步（结束录制）**：录制完动作组后，请点击“结束录制”退出录制程序即可。|
| ![teach_play](./img/app/teach_play.jpg) | **第四步（复现播放）**：新文件会显示在下方存放栏，可点击“播放”键让哮天复现新录制的动作。|
| ![teach_setting](./img/app/teach_setting.jpg) | **第五步**：点击标注一进入参数修改页面，在此页面您可以调节电机速度、电机加速度、播放速度、命名等参数，并进行修改、保存倒库或删除。|

### 3.3 示例动作组

示例待补

### 3.4 更多操作

![teach_more](./img/app/teach_more.jpg)

| 参数项 | 相关含义及操作 | 备注 |
|-----|-----|-----|
| **调节播放速度（标注二）**| 拉动滑条进行调节录制的动作组播放速度 | |
| **如何重新命名（标注三）**| 对标注处修改即可，支持中英文更名。||
| **调节电机速度（标注四）**| 电机速度调节有四个选项：最快、快、慢、最慢 | 如果将电机速度调至最快，电机的反应速度最快，也就代表会快速完成动作组的动作。以此类推，如果将电机速度调至最慢，而动作组的动作则会以缓慢且丝滑的状态完成。|
| **调节电机加速度（标注五）**| 电机加速度调节有四个选项：最快、快、慢、最慢 |
| **保存动作至库（标注六）**| 将此动作组存放进动作库，可在遥控模式下查询此动作组 |
| **删除动作组（标注七**）| 点击“删除此动作”即可移除相应的动作组 |

了解页面如何使用后，接下来请跟随示例动作组教程来创建哮天第一个专属动作组吧！

## 四、编辑模式

"编辑模式提供了比示教更精准的控制能力，允许调整哮天每一帧的动作细节：包括速度、加速度、停顿时间以及角度等参数；编辑参数的同时会把数值发送到机身同步调整。这种模式使得每一帧动作都能得到精准调整，从而实现更高精度和高控制度。"

### 4.1 进入编辑模式

| 示例图 | 操作描述 |
|------|-----|
|![open_editor_mode](./img/app/open_editor_mode.jpg)|我们可通过顶栏**切换到编辑模式，进入页面后提示恢复初始姿态，按“确认”即可**。编辑页面展示了哮天在初始姿态时的关节参数，供用户在编辑动作时作为参考依据|

### 4.2 新建关键帧

| 示例图 | 操作描述 |
|------|-----|
|![new_editor](./img/app/new_editor.jpg)|**第一步：新建关键帧**：点击 “添加关键帧”进入关键帧编辑页面。**第二步：编辑页面**：用户可在编辑页面修改头部、机身、右后腿、左后腿、左前腿、右前腿的 XYZ 三轴参数并创建哮天一帧的关键帧，并进行保存、另存为、删除等操作。|

### 4.3 示例关键帧

>以下为创造一帧哮天的抬头扭屁股的关键帧示例，具体参数值仅供参考。

| 关节 | 参数定义|
|-----|-----|
| **头部** | `Yaw`：控制颈部左右转动、`Pitch`：控制头部上下运动。 |
| **机身** | `Roll`：控制机身的滚转运动、`Pitch`：控制机身的俯仰运动、`Yaw`：控制机身的偏航运动。 |
| **腿部** | `X轴`：控制腿部前后移动、`Y轴`：控制腿部左右摆动、`Z轴`：控制腿部上下活动。 |

了解我们可修改的关节、参数及它的定义后就开始创造一帧新的关键帧啦！

| 操作步骤 | 示例图 |
|---------|-------|
|**第一步编辑头部参数**：我们要实现一帧哮天抬头扭屁股的关键帧。为此头部需修改 `Pitch 参数`来实现抬起，同时为了让哮天看起来更加灵动，对 `Yaw 参数`进行修改实现颈部左右转向功能。| ![editor_head](./img/app/editor_head.jpg) |
| **第二步编辑机身参数**：头部抬起时，为了让整体动作更加协调尝试机身也修改 `Pitch 参数`，以机身尾部的屁股抬高，前部低下的姿态去实现扭屁股的动作，而在颈部我们还添加 `Yaw 参数`，机身也可以微调此参数。|![editor_body](./img/app/editor_body.jpg) |

**第三步编辑四足参数**：调整时需注意各腿部的原始参数，以确保动作自然协调。腿部可进行修改的有左后腿、右后腿、左前腿及右前腿，配合机身的姿势需调整腿部的上下参数，将前腿的位置调低、后腿的位置调高让哮天实现扭屁股的姿态。

| 右后腿示意图| 左后腿示意图 |
|-----|-----|
|![right_after](./img/app/right_after.jpg)| ![left_after](./img/app/left_after.jpg)|

但此时在微调的过程中我们发现后腿调高后，哮天可能会出现站不稳的情况。这时可微调后腿的前后、左右参数，让后腿的支撑面更广并站的更稳当。

| 左前腿示意图| 右前腿示意图 |
|-----|-----|
| ![the_front_left](./img/app/the_front_left.jpg)| ![the_front_right](./img/app/the_front_right.jpg)|

完成所有的调整参数后，我们可以将关键帧调整到 200ms 来观察哮天。来一起看看效果吧！  
以上参数仅供参考，用户可自行根据想法来进行微调动作。

> 视频

### 4.4 更多操作 

- **调整电机参数**

| 参数项 | 相关含义及操作 | 备注 |
|-----|-----|-----|
| **调节电机速度（标注一）** | 电机速度调节有四个选项：最快、快、慢、最慢 | 如果将电机速度调至最快，电机的反应速度最快，也就代表会快速完成动作组的动作。以此类推，如果将电机速度调至最慢，而动作组的动作则会以缓慢且丝滑的状态完成。 |
| **调节电机加速度（标注二)** | 电机加速度调节有四个选项：最快、快、慢、最慢 | |
| **调节关键帧时间（标注三）**| 可在此调节关键帧的时间，建议以200ms为一帧的时间。 ||

![aia](./img/app/aia.jpg)

- **保存、另存为、删除关键帧**

| 参数项 | 相关含义及操作 | 
|-----|-----|
| **保存至此关键帧** | 点击此选项可将当前编辑的关键帧保存至当前动作序列中。| 
| **另存至新关键帧** | 选择此选项可以将当前编辑的关键帧作为一个新的独立关键帧保存。 |
| **删除此关键帧** | 点击此选项可从动作序列中移除当前选择的关键帧。| 

![save](./img/app/save.jpg)